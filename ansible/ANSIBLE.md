# Ansible

## lab5 

### 50 last lines of the output of the your deployment command 

After Running ```ansible-playbook playbooks/dev/main.yml --diff```
 
```
TASK [docker : Install docker-compose plugin.] ************************************************************************************************************************************************************
skipping: [vm1]

TASK [docker : Install docker-compose-plugin (with downgrade option).] ************************************************************************************************************************************
skipping: [vm1]

TASK [docker : Ensure /etc/docker/ directory exists.] *****************************************************************************************************************************************************
skipping: [vm1]

TASK [docker : Configure Docker daemon options.] **********************************************************************************************************************************************************
skipping: [vm1]

TASK [docker : Ensure Docker is started and enabled at boot.] *********************************************************************************************************************************************
ok: [vm1]

TASK [docker : Ensure handlers are notified now to avoid firewall conflicts.] *****************************************************************************************************************************

RUNNING HANDLER [docker : restart docker] *****************************************************************************************************************************************************************
changed: [vm1]

TASK [docker : include_tasks] *****************************************************************************************************************************************************************************
included: /home/khalil/Desktop/study/Devops-labs/ansible/roles/docker/tasks/docker-compose.yml for vm1

TASK [docker : Check current docker-compose version.] *****************************************************************************************************************************************************
ok: [vm1]

TASK [docker : set_fact] **********************************************************************************************************************************************************************************
ok: [vm1]

TASK [docker : Delete existing docker-compose version if it's different.] *********************************************************************************************************************************
ok: [vm1]

TASK [docker : Install Docker Compose (if configured).] ***************************************************************************************************************************************************
changed: [vm1]

TASK [docker : Get docker group info using getent.] *******************************************************************************************************************************************************
skipping: [vm1]

TASK [docker : Check if there are any users to add to the docker group.] **********************************************************************************************************************************

TASK [docker : include_tasks] *****************************************************************************************************************************************************************************
skipping: [vm1]

PLAY RECAP ************************************************************************************************************************************************************************************************
vm1                        : ok=16   changed=6    unreachable=0    failed=0    skipped=12   rescued=0    ignored=0   
```
 
 
### output of the following command: 

``ansible-inventory -i inventory/main.yml --list ``

```

    {
        "_meta": {
            "hostvars": {
                "vm1": {
                    "ansible_host": "158.160.14.30",
                    "ansible_user": "test"
                }
            }
        },
        "all": {
            "children": [
                "ungrouped",
                "vms"
            ]
        },
    }

```


## Lab 6

The final output: ( around 50 lines)

```

TASK [web_app : Remove app directory] *********************************************************************************************************************************************************************
--- before
+++ after
@@ -1,10 +1,4 @@
 {
     "path": "/opt/py_app",
-    "path_content": {
-        "directories": [],
-        "files": [
-            "/opt/py_app/docker-compose.yml"
-        ]
-    },
-    "state": "directory"
+    "state": "absent"
 }

changed: [vm1]

TASK [web_app : Start Docker service] *********************************************************************************************************************************************************************
ok: [vm1]

TASK [web_app : Create app directory] *********************************************************************************************************************************************************************
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/py_app",
-    "state": "absent"
+    "state": "directory"
 }

changed: [vm1]

TASK [web_app : Template a docker file] *******************************************************************************************************************************************************************
--- before
+++ after: /home/khalil/.ansible/tmp/ansible-local-44005ww46rmts/tmp1851bk5z/docker-compose.yml.j2
@@ -0,0 +1,9 @@
+version: "3.9"
+
+services:
+  py_app:
+    image: mkhalil99/py_app:latest
+    container_name: py_app
+    ports:
+      - "8000:8000"
+    restart: always

changed: [vm1]

TASK [web_app : Start all services] ***********************************************************************************************************************************************************************
changed: [vm1]

PLAY RECAP ************************************************************************************************************************************************************************************************
vm1                        : ok=22   changed=5    unreachable=0    failed=0    skipped=14   rescued=0    ignored=0   

```
